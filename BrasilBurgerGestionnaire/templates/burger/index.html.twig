{% extends 'base.html.twig' %}

{% block title %}Gestion des burgers
{% endblock %}

{% block page_title %}Gestion des burgers
{% endblock %}

{% block body %}
	<!-- Bouton ajouter -->
	<div class="row mb-4">
		<div class="col-md-12">
			<a href="{{ path('app_burger_new') }}" class="btn btn-danger">
				<i class="bi bi-plus-circle"></i>
				Nouveau burger
			</a>
		</div>
	</div>

	<!-- Liste des burgers -->
	<div class="row">
		{% if burgers is empty %}
			<div class="col-md-12">
				<div class="card">
					<div class="card-body text-center py-5">
						<i class="bi bi-circle text-muted" style="font-size: 4rem;"></i>
						<h4 class="mt-3">Aucun burger</h4>
						<p class="text-muted">Créez votre premier burger pour commencer.</p>
						<a href="{{ path('app_burger_new') }}" class="btn btn-danger mt-3">
							<i class="bi bi-plus-circle"></i>
							Créer un burger
						</a>
					</div>
				</div>
			</div>
		{% else %}
			{% for burger in burgers %}
				<div class="col-md-4 mb-4">
					<div class="card h-100 {% if burger.isArchived %}border-secondary{% endif %}">
						{% if burger.imageUrl %}
							<img src="{{ burger.imageUrl }}" class="card-img-top" alt="{{ burger.libelle }}" style="height: 200px; object-fit: cover;">
						{% else %}
							<div class="bg-light d-flex align-items-center justify-content-center" style="height: 200px;">
								<i class="bi bi-image text-muted" style="font-size: 3rem;"></i>
							</div>
						{% endif %}

						<div class="card-body">
							<div class="d-flex justify-content-between align-items-start mb-2">
								<h5 class="card-title mb-0">{{ burger.libelle }}</h5>
								{% if burger.isArchived %}
									<span class="badge bg-secondary">Archivé</span>
								{% else %}
									<span class="badge bg-success">Actif</span>
								{% endif %}
							</div>

							{% if burger.categorie %}
								<p class="mb-2">
									<span class="badge bg-light text-dark">{{ burger.categorie.nom }}</span>
								</p>
							{% endif %}

							{% if burger.description %}
								<p class="card-text text-muted small">
									{{ burger.description|slice(0, 80) }}
									{% if burger.description|length > 80 %}...
									{% endif %}
								</p>
							{% endif %}

							<h4 class="text-danger mb-3">{{ burger.prix|number_format(0, ',', ' ') }}
								FCFA</h4>

							<div class="d-grid gap-2">
								<a href="{{ path('app_burger_edit', {id: burger.id}) }}" class="btn btn-primary btn-sm">
									<i class="bi bi-pencil"></i>
									Modifier
								</a>
								<form method="post" action="{{ path('app_burger_archive', {id: burger.id}) }}">
									<input type="hidden" name="_token" value="{{ csrf_token('archive_burger_' ~ burger.id) }}">
									<button type="submit" class="btn btn-outline-secondary btn-sm w-100">
										{% if burger.isArchived %}
											<i class="bi bi-arrow-counterclockwise"></i>
											Désarchiver
										{% else %}
											<i class="bi bi-archive"></i>
											Archiver
										{% endif %}
									</button>
								</form>
							</div>
						</div>
					</div>
				</div>
			{% endfor %}
		{% endif %}
	</div>

	<!-- Pagination -->
	{% if burgers.pageCount > 1 %}
		<div class="d-flex justify-content-center mt-4">
			{{ knp_pagination_render(
                burgers,
                '@KnpPaginator/Pagination/twitter_bootstrap_v4_pagination.html.twig',
                {},
                {
                    'prev_label': '← Précédent',
                    'next_label': 'Suivant →'
                }
            ) }}
		</div>
	{% endif %}
{% endblock %}
